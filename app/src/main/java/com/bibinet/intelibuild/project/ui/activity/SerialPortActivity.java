package com.bibinet.intelibuild.project.ui.activity;import android.content.Intent;import android.support.v7.widget.AppCompatImageView;import android.view.View;import android.widget.Button;import android.widget.TextView;import com.bibinet.intelibuild.R;import com.bibinet.intelibuild.mvp.presenter.SerialPortActivityPresenter;import com.bibinet.intelibuild.mvp.view.SerialPortActivityView;import com.bibinet.intelibuild.project.application.Constants;import com.bibinet.intelibuild.project.ui.baseui.BaseActivity;import com.bibinet.intelibuild.project.utils.ClearDataUtils;import butterknife.BindView;import butterknife.OnClick;/** * Created by bibinet on 2018-1-3. */public class SerialPortActivity extends BaseActivity implements SerialPortActivityView {    @BindView(R.id.checkProductNmber)    TextView checkProductNmber;    @BindView(R.id.proFileNumber)    TextView proFileNumber;    @BindView(R.id.productFile)    TextView productFile;    @BindView(R.id.productName)    TextView productName;    @BindView(R.id.productNumb)    TextView productNumb;    @BindView(R.id.checkProjcet)    TextView checkProjcet;    @BindView(R.id.doStandard)    TextView doStandard;    @BindView(R.id.firstChcekNumb)    TextView firstChcekNumb;    @BindView(R.id.secondChcekNumb)    TextView secondChcekNumb;    @BindView(R.id.thridChcekNumb)    TextView thridChcekNumb;    @BindView(R.id.nextProductCheck)    Button nextProductCheck;    @BindView(R.id.image_result)    AppCompatImageView imageResult;    private SerialPortActivityPresenter serialPortActivityPresenter;    private String isCorrect="false";//检测结果是否合格    @Override    protected int getChildlayout() {        return R.layout.activity_serialport;    }    @Override    protected void initView() {        title.setText("样品检测");        serialPortActivityPresenter=new SerialPortActivityPresenter(this);        productFile.setText(Constants.serialProductFileName);        proFileNumber.setText(Constants.serialProductFileNumb);        productName.setText(Constants.serialProductName);        productNumb.setText(Constants.serialProductNumber);        checkProjcet.setText(Constants.serialCheckProject);        doStandard.setText(Constants.serialDoStand);    }    @OnClick({R.id.title_imageleft, R.id.nextProductCheck})    public void onViewClicked(View view) {        switch (view.getId()) {            case R.id.title_imageleft:                finish();                break;            case R.id.nextProductCheck:                if (isCorrect.equals("false")) {                    finish();                    return;                }                if (Constants.SerialCheckNumber==1) {                    doPostData("1",firstChcekNumb.getText().toString());                    Constants.SerialCheckNumber++;                    Intent intent=new Intent(this,RfidScanActivity.class);                    startActivity(intent);                }else if (Constants.SerialCheckNumber==2) {                    doPostData("2",secondChcekNumb.getText().toString());                    Constants.SerialCheckNumber++;                    Intent intent=new Intent(this,RfidScanActivity.class);                    startActivity(intent);                }else {                    doPostData("3",thridChcekNumb.getText().toString());                    ProductInfoEnsureActivity.isFirstConnect=false;                    ClearDataUtils.clearSerialData();                    finish();                }                break;        }    }    private void doPostData(String checkNumber,String checkData) {        serialPortActivityPresenter.postSerialData(this,"userId",checkNumber,proFileNumber.getText().toString(),productFile.getText().toString(),productName.getText().toString(),                productNumb.getText().toString(),checkProjcet.getText().toString(),doStandard.getText().toString(),checkData,isCorrect);    }    @Override    public void onPostSerialPortActivitySucess() {        //如果样品检测不合格，则终止检测        if (isCorrect.equals("false")) {            nextProductCheck.setText("完成样品检测");            return;        }        if (Constants.SerialCheckNumber==1) {            checkProductNmber.setText("第一个样品检测");            nextProductCheck.setText("下一个样品检测");        }else if (Constants.SerialCheckNumber==2) {            checkProductNmber.setText("第二个样品检测");            nextProductCheck.setText("下一个样品检测");        }else {            checkProductNmber.setText("第三个样品检测");            nextProductCheck.setText("完成样品检测");        }    }    @Override    public void onPostSerialPortActivityFailed() {    }}